---
title: "Econom√©trie_var_quali"
author: "Moussa"
date: "2024-09-02"
output:
  pdf_document: default
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Charger les donn√©es 

```{r}
library(readr)
Essence <- read_delim("Econom√©trie des var_qualitatives/Dataset/R2.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
```


# Statistiques descriptives
```{r}
summary(Essence)
```

```{r}
str(Essence)
```

# Cr√©er la variable de consommation d'essence par t√™te

```{r}
Essence$GPOP <- Essence$G / Essence$POP

# Cr√©er les variables en logarithme
Essence$LOGGPOP <- log(Essence$GPOP)
Essence$LOGPG <- log(Essence$PG)
Essence$LOGY <- log(Essence$Y)
Essence$LOGPNC <- log(Essence$PNC)
Essence$LOGPPUC <- log(Essence$PUC)

# Afficher les premi√®res lignes du dataframe mis √† jour
head(Essence)

```
# 5. Quelle est la moyenne de l'indice des prix des nouvelles voitures? La m√©diane de l'indice des prix des voitures d'occasion? La variance de la consommation par t√™te. 

```{r}
moyenne_pnc <- mean(Essence$PNC, na.rm = TRUE)
print(paste("Moyenne de l'indice des prix des nouvelles voitures :", round(moyenne_pnc,2)))
# M√©diane de l'indice des prix des voitures d'occasion (PUC)
mediane_puc <- median(Essence$PUC, na.rm = TRUE)
print(paste("M√©diane de l'indice des prix des voitures d'occasion:", round(mediane_puc, 2)))

# Variance de la consommation par t√™te (GPOP)
variance_gpop <- var(Essence$GPOP, na.rm = TRUE)
print(paste("Variance de la consommation par t√™te:", round(variance_gpop, 2)))

# Statistiques descriptives suppl√©mentaires
summary(Essence[, c("PNC", "PUC", "GPOP")])
```
# 6. Effectuez une r√©gression simple dont les r√©sultats seront stock√©s dans regtotal, avec pour endog√®ne LOGGPOP et pour exog√®ne LOGY. Interpr√©tez les r√©sultats. Cr√©ez l'objet droitegpopy qui correspond aux valeurs pr√©dites ùêøùëÇùê∫ùê∫ùëÉùëÇùëÉ ÃÇ de la r√©gression. (En reprenant manuellement les coefficients de la r√©gression). Affichez la droite de r√©gression sur le nuage de points.
```{r}
regtotal=lm(LOGGPOP~LOGY, data = Essence)
summary(regtotal)
sum(regtotal$residuals)
deviance(regtotal)
```
# Une regression lin√©aire uniquement pour les hommes
```{r}
regtotal_Masculin=lm(LOGGPOP~LOGY, Gender=="M", data = Essence)
summary(regtotal_Masculin)
```

# On constate que le LOGY est significatif au seuil de 5 % voire 10 % : alors de ce fait on r√©jette l'hypoth√®se nullit√© de var explicatives. 
- On constate aussi que le R¬≤ est de 65% cad le mod√®le explique 65% de notre variance (information ) totale.

# Cr√©er l'objet droitegpopy avec les valeurs pr√©dites 

```{r}

coefficients <- coef(regtotal)
Essence$droitegpopy <- coefficients[1] + coefficients[2] * Essence$LOGY

```

# Cr√©er le nuage de points avec la droite de r√©gression

```{r}
plot(Essence$LOGY, Essence$LOGGPOP, 
     main = " Effet du revenu sur la consommaton d'essence",
     xlab = "Log du revenu (LOGY)", 
     ylab = "Log de la consommation d'essence par t√™te (LOGGPOP)")
abline(regtotal, col = "red")
```
# 7. Effectuez la m√™me r√©gression sur la p√©riode 1960-1975 (observations de 1 √† 16). Stockez les r√©sultats dans 
reg1. Faites de m√™me sur la p√©riode 1976-1995 et stockez les r√©sultats dans reg2. Affichez les droites de 
r√©gression correspondantes sur le graphique pr√©c√©dent. Que constatez-vous? Quel test(s) serai(en)t alors 
appropri√©(s)?


```{r}
# R√©gression pour la p√©riode 1960-1975
reg1 <- lm(LOGGPOP ~ LOGY, data = Essence[1:16,])
summary(reg1)

reg2 <- lm(LOGGPOP ~ LOGY, data = Essence[17:36,])
summary(reg2)

```


# Cr√©er le graphique
```{r}
plot(Essence$LOGY, Essence$LOGGPOP, 
     main = "R√©gression de LOGGPOP sur LOGY pour diff√©rentes p√©riodes",
     xlab = "Log du revenu (LOGY)", 
     ylab = "Log de la consommation d'essence par t√™te (LOGGPOP)")
# Ajouter les droites de r√©gression
abline(regtotal, col = "black", lwd = 2)
abline(reg1, col = "red", lwd = 2)
abline(reg2, col = "blue", lwd = 2)
# Au lieu de prendre toutes les droites ....
```
# 8. Estimez les mod√®les suivants :
Mod√®le 1 : log (
ùê∫
ùëÉùëúùëù) = ùõΩ1 + ùõΩ2
. log(ùëå) + ùõΩ3
. log(ùëÉùê∫) + ùúÄ
Mod√®le 2 : log (
ùê∫
ùëÉùëúùëù) = ùõΩ1 + ùõΩ2
. log(ùëå) + ùõΩ3
. log(ùëÉùê∫) + ùõΩ4
. log(ùëÉùëõùê∂) + ùúÄ
Mod√®le 3 : log (
ùê∫
ùëÉùëúùëù) = ùõΩ1 + ùõΩ2
. log(ùëå) + ùõΩ3
. log(ùëÉùê∫) + ùõΩ4
. log(ùëÉùëõùê∂) + ùõΩ5
. log(ùëÉùë¢ùê∂) + ÔøΩ

```{r}
# Mod√®le 1
modele1 <- lm(LOGGPOP ~ LOGY + LOGPG, data = Essence)
summary(modele1)

# Mod√®le 2
modele2 <- lm(LOGGPOP ~ LOGY + LOGPG + LOGPNC, data = Essence)
summary(modele2)

# Mod√®le 3
modele3 <- lm(LOGGPOP ~ LOGY + LOGPG + LOGPNC + LOGPUC, data = Essence)
summary(modele3)




```

